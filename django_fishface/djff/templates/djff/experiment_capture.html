{% extends "djff/base.html" %}
{% load staticfiles %}
{% load djff_filters %}

{% block subtitle %}Capture Imagery{% endblock %}



{% block content %}
    <em>Experiment Name:</em><br />
    <strong>
        <a href="{% url 'djff:experiment_rename' xp.id %}">
            {{ xp.experiment_name }}
        </a>
    </strong>

    <hr>
    {% if not cal_images %}
        <p>The first image captured for an experiment must be
        a <em>calibration image</em>.  No fish should be in the flume,
        but otherwise the configuration of the lighting, etc.
        should be exactly as it will be during the data capture.</p>
    {% endif %}
    <form method="post"
          action="{% url 'djff:experiment_capturer' %}">
        {% csrf_token %}

        <input type="hidden" value="0" name="voltage">
        <input type="hidden" value="True" name="is_cal_image">
        <input type="checkbox" value="True" name="cal_ready">
        Ready to capture calibration image (no fish):
        <input type="hidden" value="{{ xp.id }}" name="xp_id">
        <input type="submit" value="Capture a calibration image" />
    </form>
    <hr>
    {% if cal_images %}
    <form method="post"
          action="{% url 'djff:experiment_capturer' %}">
        {% csrf_token %}
        Voltage:<input type="number" value="0" name="voltage">
        <input type="hidden" value="False" name="is_cal_image">
        <input type="hidden" value="{{ xp.id }}" name="xp_id">
        <input type="submit" value="Capture a data image" />
    </form>
    {% endif %}


    {% if cal_images %}
        <h1>CALS</h1>
        {% for img in cal_images %}
            {{ img.linked_inline_image|replace_width:"20"|mark_safe }}
        {% endfor %}
    {% else %}
        <p>No cal images.</p>
    {% endif %}


    {% if data_images %}
        <h1>DATA</h1>
        {% for img in data_images %}
            {{ img.linked_inline_image|replace_width:"20"|mark_safe }}
        {% endfor %}
    {% else %}
        <p>No data images.</p>
    {% endif %}

{% endblock %}

{% block preview_area %}
{% endblock %}